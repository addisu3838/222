<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>·ã®·à∞·à´·â∞·äû·âΩ ·àò·ãù·åà·â•</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --accent: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #34495e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            color: #333;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
            min-height: 90vh;
        }
        
        .header {
            background: linear-gradient(135deg, var(--secondary), var(--dark));
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 1.4rem;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .header .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            color: #ecf0f1;
        }
        
        .tabs-container {
            display: flex;
            overflow-x: auto;
            background: var(--light);
            padding: 10px 5px;
            gap: 8px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .tabs-container::-webkit-scrollbar {
            display: none;
        }
        
        .tab-button {
            flex: 0 0 auto;
            padding: 12px 16px;
            background: white;
            border: 2px solid transparent;
            border-radius: 12px;
            color: var(--dark);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .tab-button:hover {
            transform: translateY(-2px);
        }
        
        .tab-button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .content-area {
            padding: 15px;
            overflow-y: auto;
            max-height: calc(100vh - 180px);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--dark);
            color: white;
            padding: 12px 8px;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .data-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .data-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .data-table tr:hover {
            background: #e8f4fc;
        }
        
        .numeric-cell {
            font-weight: 600;
            color: var(--dark);
        }
        
        .weekend-row {
            background: #fff8e1 !important;
        }
        
        .total-row {
            background: var(--secondary) !important;
            color: white;
            font-weight: 700;
        }
        
        .empty-cell {
            color: #bbb;
        }
        
        .date-cell {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.2rem;
            }
            
            .tab-button {
                padding: 10px 14px;
                font-size: 0.85rem;
            }
            
            .data-table {
                font-size: 0.8rem;
            }
            
            .data-table th,
            .data-table td {
                padding: 8px 6px;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 15px 10px;
            }
            
            .header h1 {
                font-size: 1.1rem;
            }
            
            .tab-button {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }
        
        /* Loading state */
        .loader {
            text-align: center;
            padding: 40px;
            color: var(--primary);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üë∑ ·ã®·à∞·à´·â∞·äû·âΩ ·àò·ãù·åà·â•</h1>
            <div class="subtitle">30 ·âÄ·äì·âµ ·ã®·à•·à´ ·àõ·àµ·ä¨·åÉ ·àò·ãù·åà·â•</div>
        </div>
        
        <div class="tabs-container" id="tabsContainer">
            <!-- Tabs will be generated here -->
        </div>
        
        <div class="content-area" id="sheetContent">
            <div class="loader">
                <div>·àò·à®·åÉ ·â†·àò·å´·äï ·àã·ã≠...</div>
            </div>
        </div>
    </div>

    <script>
        // ONLY 7 SHEETS as requested
        const sheetsData = [
            { name: "·â∞·àµ·çã·ãâ", rows: generateTesfawuData() },
            { name: "·ã≥·â†·à®", rows: generateDabereData() },
            { name: "·å•·â†·â†", rows: generateTibebeData() },
            { name: "·â•·à©·ä≠", rows: generateBrukData() },
            { name: "·ä†·ã´·àà·ãâ", rows: generateAyalewuData() },
            { name: "·ãò·ä´·à≠·ã´·àµ", rows: generateZekariyasData() },
            { name: "·àö·ä´·ä§·àç", rows: generateMikaealData() }
        ];

        // NEW COLUMN ORDER: Guard, Dl, Time Keeper, Carpenter, Mason, Barbender
        function generateTesfawuData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            
            // Days 26-30
            data.push(["26", "3", "", "1", "", "", ""]);
            data.push(["27", "3", "", "1", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "6", "", "1", "", "", ""]);
            data.push(["30", "3", "", "1", "", "", ""]);
            
            // Days 1-25
            for (let i = 1; i <= 25; i++) {
                let guard = "";
                let timeKeeper = Math.random() > 0.2 ? "1" : "";
                
                if (i % 7 === 0) { // ·ä•·àÅ·ãµ
                    guard = Math.random() > 0.3 ? "6" : "3";
                } else {
                    guard = Math.random() > 0.2 ? "3" : "";
                }
                
                data.push([i.toString(), guard, "", timeKeeper, "", "", ""]);
            }
            
            return data;
        }

        function generateDabereData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            
            data.push(["26", "11", "1", "", "", "", ""]);
            data.push(["27", "11", "1", "", "", "", ""]);
            data.push(["28", "11", "", "", "", "", ""]);
            data.push(["29", "11", "1", "", "", "", ""]);
            data.push(["30", "11", "1", "", "", "", ""]);
            
            for (let i = 1; i <= 25; i++) {
                let guard = "";
                let dl = "";
                
                if (i % 7 === 0) { // ·ä•·àÅ·ãµ
                    guard = Math.random() > 0.3 ? "22" : "11";
                } else {
                    guard = Math.random() > 0.2 ? "11" : "";
                }
                
                if (guard && Math.random() > 0.4) {
                    dl = Math.floor(Math.random() * 3 + 1).toString();
                }
                
                data.push([i.toString(), guard, dl, "", "", "", ""]);
            }
            
            return data;
        }

        function generateTibebeData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            
            data.push(["26", "", "9.5", "", "", "", ""]);
            data.push(["27", "", "9", "", "", "", ""]);
            data.push(["28", "", "4", "", "", "", ""]);
            data.push(["29", "", "9", "", "", "", ""]);
            data.push(["30", "", "8.5", "", "", "", ""]);
            
            for (let i = 1; i <= 25; i++) {
                let dl = (Math.random() * 10 + 1).toFixed(1);
                let carpenter = Math.random() > 0.8 ? "0.5" : "";
                
                data.push([i.toString(), "", dl, "", carpenter, "", ""]);
            }
            
            return data;
        }

        function generateBrukData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            
            data.push(["26", "", "2", "", "1", "", ""]);
            data.push(["27", "8", "3", "", "1", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "4", "3", "", "1", "", ""]);
            data.push(["30", "4", "2", "", "1", "", ""]);
            
            for (let i = 1; i <= 25; i++) {
                let carpenter = Math.random() > 0.6 ? "1" : "";
                let guard = "";
                let dl = "";
                
                if (carpenter) {
                    guard = Math.random() > 0.5 ? (Math.random() > 0.5 ? "8" : "4") : "";
                    dl = Math.random() > 0.4 ? Math.floor(Math.random() * 4 + 1).toString() : "";
                }
                
                data.push([i.toString(), guard, dl, "", carpenter, "", ""]);
            }
            
            return data;
        }

        function generateAyalewuData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            
            data.push(["26", "2", "", "1", "", "", ""]);
            data.push(["27", "2", "", "1", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "4", "", "1", "", "", ""]);
            data.push(["30", "4", "", "2", "", "", ""]);
            
            for (let i = 1; i <= 25; i++) {
                let timeKeeper = Math.random() > 0.3 ? "1" : "";
                let guard = "";
                
                if (timeKeeper) {
                    guard = Math.random() > 0.5 ? 
                        (Math.random() > 0.7 ? "10" : 
                         Math.random() > 0.5 ? "5" : "2") : "";
                }
                
                data.push([i.toString(), guard, "", timeKeeper, "", "", ""]);
            }
            
            return data;
        }

        function generateZekariyasData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            
            data.push(["26", "", "", "1", "", "", ""]);
            data.push(["27", "", "", "1", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "", "1", "", "", ""]);
            data.push(["30", "", "", "2", "", "", ""]);
            
            for (let i = 1; i <= 25; i++) {
                let timeKeeper = Math.random() > 0.4 ? "1" : "";
                let dl = "";
                
                if (timeKeeper && Math.random() > 0.5) {
                    dl = (Math.random() * 10 + 1).toFixed(1);
                }
                
                data.push([i.toString(), "", dl, timeKeeper, "", "", ""]);
            }
            
            return data;
        }

        function generateMikaealData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            
            data.push(["26", "", "24", "", "", "", ""]);
            data.push(["27", "", "23", "", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "31", "", "", "", ""]);
            data.push(["30", "", "31", "", "", "", ""]);
            
            for (let i = 1; i <= 25; i++) {
                let dl = (Math.random() * 30 + 15).toFixed(1);
                
                data.push([i.toString(), "", dl, "", "", "", ""]);
            }
            
            return data;
        }

        // Telegram Mini App initialization
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            
            // Add Telegram-specific features if available
            if (window.Telegram && window.Telegram.WebApp) {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
                
                // Set theme colors
                Telegram.WebApp.setHeaderColor('#2c3e50');
                Telegram.WebApp.setBackgroundColor('#667eea');
                
                // Add back button if needed
                Telegram.WebApp.BackButton.onClick(() => {
                    Telegram.WebApp.close();
                });
            }
        });

        function initApp() {
            const tabsContainer = document.getElementById('tabsContainer');
            const sheetContent = document.getElementById('sheetContent');

            // Create only 7 tabs
            sheetsData.forEach((sheet, index) => {
                const button = document.createElement('button');
                button.className = 'tab-button';
                button.textContent = sheet.name;
                button.addEventListener('click', () => showSheet(index));
                tabsContainer.appendChild(button);
            });

            // Show first sheet
            if (sheetsData.length > 0) {
                showSheet(0);
                document.querySelector('.tab-button').classList.add('active');
            }
        }

        function calculateColumnSums(rows) {
            if (rows.length < 2) return [];
            
            const sums = new Array(rows[0].length).fill(0);
            const hasNumericData = new Array(rows[0].length).fill(false);
            
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                for (let j = 0; j < row.length; j++) {
                    const cell = row[j];
                    const num = parseFloat(cell);
                    if (!isNaN(num) && cell !== '' && cell !== ' ') {
                        sums[j] += num;
                        hasNumericData[j] = true;
                    }
                }
            }
            
            return sums.map((sum, index) => ({
                sum: sum,
                hasData: hasNumericData[index],
                columnName: rows[0][index] || `·ä†·àù·ãµ ${index}`
            }));
        }

        function showSheet(index) {
            const sheet = sheetsData[index];
            const sheetContent = document.getElementById('sheetContent');
            
            // Calculate column sums
            const columnSums = calculateColumnSums(sheet.rows);

            // Create content with animations
            sheetContent.innerHTML = '';
            sheetContent.className = 'content-area fade-in';

            // Data table
            const table = document.createElement('table');
            table.className = 'data-table';
            
            // Header
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            sheet.rows[0].forEach(cell => {
                const th = document.createElement('th');
                th.textContent = cell;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Body
            const tbody = document.createElement('tbody');
            for (let i = 1; i < sheet.rows.length; i++) {
                const row = document.createElement('tr');
                if (parseInt(sheet.rows[i][0]) % 7 === 0) {
                    row.className = 'weekend-row';
                }
                
                sheet.rows[i].forEach((cell, cellIndex) => {
                    const td = document.createElement('td');
                    if (cell === '') {
                        td.className = 'empty-cell';
                        td.textContent = '-';
                    } else {
                        if (cellIndex === 0) {
                            td.className = 'date-cell';
                        } else {
                            const num = parseFloat(cell);
                            if (!isNaN(num)) {
                                td.className = 'numeric-cell';
                                if (num >= 20) td.style.color = '#e74c3c';
                                else if (num >= 10) td.style.color = '#f39c12';
                            }
                        }
                        td.textContent = cell;
                    }
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            }
            
            // Total row
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            columnSums.forEach((col, colIndex) => {
                const td = document.createElement('td');
                if (colIndex === 0) {
                    td.textContent = '·å†·âÖ·àã·àã';
                } else if (col.hasData) {
                    td.textContent = col.sum.toFixed(2);
                } else {
                    td.textContent = '-';
                }
                totalRow.appendChild(td);
            });
            tbody.appendChild(totalRow);
            
            table.appendChild(tbody);
            sheetContent.appendChild(table);

            // Update active tab
            document.querySelectorAll('.tab-button').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
        }

        // Add touch-friendly features
        let touchStartX = 0;
        let touchEndX = 0;
        let currentTabIndex = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe left - next tab
                    currentTabIndex = (currentTabIndex + 1) % sheetsData.length;
                } else {
                    // Swipe right - previous tab
                    currentTabIndex = (currentTabIndex - 1 + sheetsData.length) % sheetsData.length;
                }
                showSheet(currentTabIndex);
            }
        }
    </script>
</body>
</html>