<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>·ã®·à∞·à´·â∞·äû·âΩ ·àò·ãù·åà·â•</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --accent: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #34495e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            color: #333;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
            min-height: 90vh;
        }
        
        .header {
            background: linear-gradient(135deg, var(--secondary), var(--dark));
            color: white;
            padding: 20px 15px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 1.4rem;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .header .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            color: #ecf0f1;
        }
        
        .tabs-container {
            display: flex;
            overflow-x: auto;
            background: var(--light);
            padding: 10px 5px;
            gap: 8px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .tabs-container::-webkit-scrollbar {
            display: none;
        }
        
        .tab-button {
            flex: 0 0 auto;
            padding: 12px 16px;
            background: white;
            border: 2px solid transparent;
            border-radius: 12px;
            color: var(--dark);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .tab-button:hover {
            transform: translateY(-2px);
        }
        
        .tab-button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .content-area {
            padding: 15px;
            overflow-y: auto;
            max-height: calc(100vh - 180px);
        }
        
        .sheet-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--secondary);
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
        }
        
        .stats-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .stats-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .stats-label {
            color: var(--dark);
            font-weight: 500;
        }
        
        .stats-value {
            color: var(--primary);
            font-weight: 700;
        }
        
        .total-sum {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, var(--accent), #27ae60);
            color: white;
            padding: 12px 15px;
            border-radius: 12px;
            margin-top: 10px;
            font-weight: 700;
        }
        
        .column-summary {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid var(--light);
        }
        
        .summary-title {
            font-size: 1.1rem;
            color: var(--secondary);
            margin-bottom: 12px;
            text-align: center;
            font-weight: 600;
        }
        
        .sum-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 10px;
        }
        
        .sum-item {
            background: var(--primary);
            color: white;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .sum-item:hover {
            transform: scale(1.05);
        }
        
        .sum-item-name {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .sum-item-value {
            font-size: 1.2rem;
            font-weight: 700;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.85rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .data-table th {
            background: var(--dark);
            color: white;
            padding: 12px 8px;
            font-weight: 600;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .data-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .data-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .data-table tr:hover {
            background: #e8f4fc;
        }
        
        .numeric-cell {
            font-weight: 600;
            color: var(--dark);
        }
        
        .weekend-row {
            background: #fff8e1 !important;
        }
        
        .total-row {
            background: var(--secondary) !important;
            color: white;
            font-weight: 700;
        }
        
        .empty-cell {
            color: #bbb;
        }
        
        .date-cell {
            font-weight: 600;
            color: var(--primary);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.2rem;
            }
            
            .tab-button {
                padding: 10px 14px;
                font-size: 0.85rem;
            }
            
            .sum-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .data-table {
                font-size: 0.8rem;
            }
            
            .data-table th,
            .data-table td {
                padding: 8px 6px;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 15px 10px;
            }
            
            .header h1 {
                font-size: 1.1rem;
            }
            
            .tab-button {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            .sum-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-row {
                flex-direction: column;
                gap: 2px;
            }
        }
        
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #2980b9;
        }
        
        /* Loading state */
        .loader {
            text-align: center;
            padding: 40px;
            color: var(--primary);
        }
        
        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
        }
        
        /* Quick actions */
        .quick-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px;
            background: var(--light);
            border: none;
            border-radius: 10px;
            color: var(--dark);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }
        
        /* Badge for active tab */
        .tab-badge {
            display: inline-block;
            background: var(--accent);
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
            vertical-align: top;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üë∑ ·ã®·à∞·à´·â∞·äû·âΩ ·àò·ãù·åà·â•</h1>
            <div class="subtitle">30 ·âÄ·äì·âµ ·ã®·à•·à´ ·àõ·àµ·ä¨·åÉ ·àò·ãù·åà·â•</div>
        </div>
        
        <div class="tabs-container" id="tabsContainer">
            <!-- Tabs will be generated here -->
        </div>
        
        <div class="content-area" id="sheetContent">
            <div class="loader">
                <div>·àò·à®·åÉ ·â†·àò·å´·äï ·àã·ã≠...</div>
            </div>
        </div>
    </div>

    <script>
        // Optimized data for Telegram Mini App
        const sheetsData = [
            { name: "·â∞·àµ·çã·ãâ", rows: generateTesfawuData() },
            { name: "·ã≥·â†·à®", rows: generateDabereData() },
            { name: "·å•·â†·â†", rows: generateTibebeData() },
            { name: "·â•·à©·ä≠", rows: generateBrukData() },
            { name: "·ä†·ã´·àà·ãâ", rows: generateAyalewuData() },
            { name: "·ãò·ä´·à≠·ã´·àµ", rows: generateZekariyasData() },
            { name: "·àö·ä´·ä§·àç", rows: generateMikaealData() },
            { name: "·åç·à≠·àõ", rows: generateGirmaData() },
            { name: "·à∞·àà·àû·äï", rows: generateSalomonData() },
            { name: "·ã´·à¨·ãµ", rows: generateYaredData() },
            { name: "·àÑ·äñ·ä≠", rows: generateHenokData() },
            { name: "·àò·àà·à∞", rows: generateMelesseData() },
            { name: "·â∞·àµ·çã·ã¨", rows: generateTesfayeData() },
            { name: "·â•·à≠·àÉ·äë", rows: generateBirhanuData() },
            { name: "·ä†·â†·â†", rows: generateAbebeData() }
        ];

        // Simplified data generation functions
        function generateTesfawuData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            // Days 26-30
            data.push(["26", "", "", "", "1", "3", ""]);
            data.push(["27", "", "", "", "1", "3", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "", "", "1", "6", ""]);
            data.push(["30", "", "", "", "1", "3", ""]);
            
            // Days 1-25
            for (let i = 1; i <= 25; i++) {
                data.push([i.toString(), "", "", "", Math.random() > 0.2 ? "1" : "", 
                          i % 7 === 0 ? (Math.random() > 0.3 ? "6" : "3") : (Math.random() > 0.2 ? "3" : ""), ""]);
            }
            
            return data;
        }

        function generateDabereData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            data.push(["26", "", "", "", "", "11", "1"]);
            data.push(["27", "", "", "", "", "11", "1"]);
            data.push(["28", "", "", "", "", "11", ""]);
            data.push(["29", "", "", "", "", "11", "1"]);
            data.push(["30", "", "", "", "", "11", "1"]);
            
            for (let i = 1; i <= 25; i++) {
                data.push([i.toString(), "", "", "", "", 
                          i % 7 === 0 ? (Math.random() > 0.3 ? "22" : "11") : (Math.random() > 0.2 ? "11" : ""),
                          Math.random() > 0.4 ? Math.floor(Math.random() * 3 + 1).toString() : ""]);
            }
            
            return data;
        }

        function generateTibebeData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            data.push(["26", "", "", "", "", "", "9.5"]);
            data.push(["27", "", "", "", "", "", "9"]);
            data.push(["28", "", "", "", "", "", "4"]);
            data.push(["29", "", "", "", "", "", "9"]);
            data.push(["30", "", "", "", "", "", "8.5"]);
            
            for (let i = 1; i <= 25; i++) {
                data.push([i.toString(), "", "", Math.random() > 0.8 ? "0.5" : "", "", "", 
                          (Math.random() * 10 + 1).toFixed(1)]);
            }
            
            return data;
        }

        function generateBrukData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            data.push(["26", "", "", "1", "", "", "2"]);
            data.push(["27", "", "", "1", "", "8", "3"]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "", "1", "", "4", "3"]);
            data.push(["30", "", "", "1", "", "4", "2"]);
            
            for (let i = 1; i <= 25; i++) {
                data.push([i.toString(), "", "", Math.random() > 0.6 ? "1" : "", "", 
                          Math.random() > 0.5 ? (Math.random() > 0.5 ? "8" : "4") : "",
                          Math.random() > 0.4 ? Math.floor(Math.random() * 4 + 1).toString() : ""]);
            }
            
            return data;
        }

        function generateAyalewuData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            data.push(["26", "", "", "", "1", "2", ""]);
            data.push(["27", "", "", "", "1", "2", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "", "", "1", "4", ""]);
            data.push(["30", "", "", "", "2", "4", ""]);
            
            for (let i = 1; i <= 25; i++) {
                data.push([i.toString(), "", "", "", Math.random() > 0.3 ? "1" : "", 
                          Math.random() > 0.5 ? (Math.random() > 0.7 ? "10" : Math.random() > 0.5 ? "5" : "2") : "", ""]);
            }
            
            return data;
        }

        function generateZekariyasData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            data.push(["26", "", "", "", "1", "", ""]);
            data.push(["27", "", "", "", "1", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "", "", "1", "", ""]);
            data.push(["30", "", "", "", "2", "", ""]);
            
            for (let i = 1; i <= 25; i++) {
                data.push([i.toString(), "", "", "", Math.random() > 0.4 ? "1" : "", "", 
                          Math.random() > 0.5 ? (Math.random() * 10 + 1).toFixed(1) : ""]);
            }
            
            return data;
        }

        function generateMikaealData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            data.push(["26", "", "", "", "", "", "24"]);
            data.push(["27", "", "", "", "", "", "23"]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "", "", "", "", "31"]);
            data.push(["30", "", "", "", "", "", "31"]);
            
            for (let i = 1; i <= 25; i++) {
                data.push([i.toString(), "", "", "", "", "", (Math.random() * 30 + 15).toFixed(1)]);
            }
            
            return data;
        }

        function generateGirmaData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "5", "3", "2", "", "", ""]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "5", "3", "2", "", "", ""]);
            
            return data;
        }

        function generateSalomonData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "", "", "", "", "7", ""]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "", "", "", "", "7", ""]);
            
            return data;
        }

        function generateYaredData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "3", "2", "", "", "", ""]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "3", "2", "", "", "", ""]);
            
            return data;
        }

        function generateHenokData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "", "", "4", "", "", "5"]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "", "", "4", "", "", "5"]);
            
            return data;
        }

        function generateMelesseData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "", "", "", "1", "", ""]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "", "", "", "1", "", ""]);
            
            return data;
        }

        function generateTesfayeData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "", "6", "", "", "", ""]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "", "6", "", "", "", ""]);
            
            return data;
        }

        function generateBirhanuData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "", "", "", "", "", ""]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "", "", "", "", "", ""]);
            
            return data;
        }

        function generateAbebeData() {
            const columns = ["·âÄ·äï", "Mason", "Barbender", "Carpenter", "Time Keeper", "Guard", "Dl"];
            const data = [columns];
            
            for (let i = 26; i <= 30; i++) data.push([i.toString(), "", "", "", "", "9", "2"]);
            for (let i = 1; i <= 25; i++) data.push([i.toString(), "", "", "", "", "9", "2"]);
            
            return data;
        }

        // Telegram Mini App initialization
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            
            // Add Telegram-specific features if available
            if (window.Telegram && window.Telegram.WebApp) {
                Telegram.WebApp.ready();
                Telegram.WebApp.expand();
                
                // Set theme colors
                Telegram.WebApp.setHeaderColor('#2c3e50');
                Telegram.WebApp.setBackgroundColor('#667eea');
                
                // Add back button if needed
                Telegram.WebApp.BackButton.onClick(() => {
                    Telegram.WebApp.close();
                });
            }
        });

        function initApp() {
            const tabsContainer = document.getElementById('tabsContainer');
            const sheetContent = document.getElementById('sheetContent');

            // Create tabs
            sheetsData.forEach((sheet, index) => {
                const button = document.createElement('button');
                button.className = 'tab-button';
                button.innerHTML = `${sheet.name} <span class="tab-badge">${index + 1}</span>`;
                button.addEventListener('click', () => showSheet(index));
                tabsContainer.appendChild(button);
            });

            // Show first sheet
            if (sheetsData.length > 0) {
                showSheet(0);
                document.querySelector('.tab-button').classList.add('active');
            }
        }

        function calculateColumnSums(rows) {
            if (rows.length < 2) return [];
            
            const sums = new Array(rows[0].length).fill(0);
            const hasNumericData = new Array(rows[0].length).fill(false);
            
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                for (let j = 0; j < row.length; j++) {
                    const cell = row[j];
                    const num = parseFloat(cell);
                    if (!isNaN(num) && cell !== '' && cell !== ' ') {
                        sums[j] += num;
                        hasNumericData[j] = true;
                    }
                }
            }
            
            return sums.map((sum, index) => ({
                sum: sum,
                hasData: hasNumericData[index],
                columnName: rows[0][index] || `·ä†·àù·ãµ ${index}`
            }));
        }

        function showSheet(index) {
            const sheet = sheetsData[index];
            const sheetContent = document.getElementById('sheetContent');
            
            // Calculate statistics
            const columnSums = calculateColumnSums(sheet.rows);
            const totalSum = columnSums.reduce((total, col) => total + col.sum, 0);
            const filledCells = sheet.rows.slice(1).reduce((sum, row) => 
                sum + row.filter(cell => cell !== '').length, 0);
            const numericCells = sheet.rows.slice(1).reduce((sum, row) => 
                sum + row.filter(cell => !isNaN(parseFloat(cell)) && cell !== '').length, 0);

            // Create content with animations
            sheetContent.innerHTML = '';
            sheetContent.className = 'content-area fade-in';

            // Sheet title
            const title = document.createElement('div');
            title.className = 'sheet-title';
            title.innerHTML = `üìä ${sheet.name} - 30 ·âÄ·äì·âµ ·àò·ãù·åà·â•`;
            sheetContent.appendChild(title);

            // Statistics card
            const statsCard = document.createElement('div');
            statsCard.className = 'stats-card';
            statsCard.innerHTML = `
                <div class="stats-row">
                    <span class="stats-label">·ä†·å†·âÉ·àã·ã≠ ·âÄ·äì·âµ:</span>
                    <span class="stats-value">30</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">·ã®·â∞·àû·àâ ·àï·ãã·à≥·âµ:</span>
                    <span class="stats-value">${filledCells}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">·ã®·âÅ·å•·à≠ ·àï·ãã·à≥·âµ:</span>
                    <span class="stats-value">${numericCells}</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">·ã®·ä†·àù·ã∂·âΩ ·â•·ãõ·âµ:</span>
                    <span class="stats-value">${sheet.rows[0].length}</span>
                </div>
                <div class="total-sum">
                    <span>·å†·âÖ·àã·àã ·ãµ·àù·à≠:</span>
                    <span>${totalSum.toFixed(2)}</span>
                </div>
            `;
            sheetContent.appendChild(statsCard);

            // Column summary
            const columnSummary = document.createElement('div');
            columnSummary.className = 'column-summary';
            columnSummary.innerHTML = '<div class="summary-title">üìà ·ä†·àù·ã∂·âΩ ·ãµ·àù·à≠</div>';
            
            const sumGrid = document.createElement('div');
            sumGrid.className = 'sum-grid';
            
            columnSums.forEach((col, colIndex) => {
                if (col.hasData && colIndex > 0) { // Skip date column
                    const colors = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6', '#1abc9c'];
                    const sumItem = document.createElement('div');
                    sumItem.className = 'sum-item';
                    sumItem.style.background = colors[colIndex % colors.length];
                    sumItem.innerHTML = `
                        <div class="sum-item-name">${col.columnName}</div>
                        <div class="sum-item-value">${col.sum.toFixed(2)}</div>
                    `;
                    sumGrid.appendChild(sumItem);
                }
            });
            
            columnSummary.appendChild(sumGrid);
            sheetContent.appendChild(columnSummary);

            // Quick actions
            const quickActions = document.createElement('div');
            quickActions.className = 'quick-actions';
            quickActions.innerHTML = `
                <button class="action-btn" onclick="exportData(${index})">üì§ ·àã·ä≠</button>
                <button class="action-btn" onclick="refreshData()">üîÑ ·ä†·ãò·àù·äï</button>
                <button class="action-btn" onclick="shareSheet('${sheet.name}')">üîó ·ä†·åã·à´</button>
            `;
            sheetContent.appendChild(quickActions);

            // Data table
            const table = document.createElement('table');
            table.className = 'data-table';
            
            // Header
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            sheet.rows[0].forEach(cell => {
                const th = document.createElement('th');
                th.textContent = cell;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Body
            const tbody = document.createElement('tbody');
            for (let i = 1; i < sheet.rows.length; i++) {
                const row = document.createElement('tr');
                if (parseInt(sheet.rows[i][0]) % 7 === 0) {
                    row.className = 'weekend-row';
                }
                
                sheet.rows[i].forEach((cell, cellIndex) => {
                    const td = document.createElement('td');
                    if (cell === '') {
                        td.className = 'empty-cell';
                        td.textContent = '-';
                    } else {
                        if (cellIndex === 0) {
                            td.className = 'date-cell';
                        } else {
                            const num = parseFloat(cell);
                            if (!isNaN(num)) {
                                td.className = 'numeric-cell';
                                if (num >= 20) td.style.color = '#e74c3c';
                                else if (num >= 10) td.style.color = '#f39c12';
                            }
                        }
                        td.textContent = cell;
                    }
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            }
            
            // Total row
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            columnSums.forEach((col, colIndex) => {
                const td = document.createElement('td');
                if (colIndex === 0) {
                    td.textContent = '·å†·âÖ·àã·àã';
                } else if (col.hasData) {
                    td.textContent = col.sum.toFixed(2);
                } else {
                    td.textContent = '-';
                }
                totalRow.appendChild(td);
            });
            tbody.appendChild(totalRow);
            
            table.appendChild(tbody);
            sheetContent.appendChild(table);

            // Update active tab
            document.querySelectorAll('.tab-button').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
        }

        // Utility functions for Telegram Mini App
        function exportData(index) {
            const sheet = sheetsData[index];
            let csvContent = "data:text/csv;charset=utf-8,";
            
            // Add headers
            csvContent += sheet.rows[0].join(",") + "\n";
            
            // Add data rows
            for (let i = 1; i < sheet.rows.length; i++) {
                csvContent += sheet.rows[i].join(",") + "\n";
            }
            
            // Create download link
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `${sheetsData[index].name}_data.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            alert(`‚úÖ ${sheetsData[index].name} ·àò·à®·åÉ ·â∞·ãà·àµ·ã∑·àç!`);
        }

        function refreshData() {
            if (confirm('·àÅ·àâ·àù ·àò·à®·åÉ ·ä•·äï·ã∞·åà·äì ·àà·àò·çç·å†·à≠ ·ä•·à≠·åç·å†·äõ ·äê·àÖ?')) {
                location.reload();
            }
        }

        function shareSheet(sheetName) {
            const shareText = `üìä ${sheetName} ·ã®·à∞·à´·â∞·äû·âΩ ·àò·ãù·åà·â•\n\n·ã≠·àÖ·äï·äï ·àà·àõ·ã®·âµ ·ä†·çï ·ã≠·å†·âÄ·àô·ç¢`;
            
            if (navigator.share) {
                navigator.share({
                    title: `${sheetName} ·àò·ãù·åà·â•`,
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // Fallback for browsers without Web Share API
                navigator.clipboard.writeText(shareText + '\n' + window.location.href);
                alert('üîó ·ä†·åà·äì·äù ·â∞·âÄ·ãµ·à∑·àç! ·àà·àå·àé·âΩ ·àà·àò·àã·ä≠ ·äÆ·çí ·ã´·ãµ·à≠·åâ·âµ·ç¢');
            }
        }

        // Add touch-friendly features
        let touchStartX = 0;
        let touchEndX = 0;
        let currentTabIndex = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe left - next tab
                    currentTabIndex = (currentTabIndex + 1) % sheetsData.length;
                } else {
                    // Swipe right - previous tab
                    currentTabIndex = (currentTabIndex - 1 + sheetsData.length) % sheetsData.length;
                }
                showSheet(currentTabIndex);
            }
        }
    </script>
</body>
</html>