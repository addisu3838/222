<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>·ä§·ä≠·à¥·àç ·àò·ãõ·åç·â•·âµ - 30 ·âÄ·äì·âµ ·ãç·àÇ·â•</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background-color: #f8f9fa;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 25px;
            justify-content: center;
            padding: 10px;
            background: #ecf0f1;
            border-radius: 10px;
        }
        .tab-button {
            padding: 10px 18px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            min-width: 100px;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .tab-button:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        .tab-button.active {
            background-color: #2c3e50;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .sheet-container {
            overflow-x: auto;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            min-width: 1200px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px 10px;
            text-align: center;
            font-size: 13px;
        }
        th {
            background-color: #2c3e50;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #e8f4fc;
        }
        .sheet-title {
            font-size: 22px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        .stats {
            background: #e8f6f3;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .stats span {
            font-weight: bold;
            color: #16a085;
        }
        .column-summary {
            background: #fffde7;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .column-summary h3 {
            color: #f39c12;
            margin-top: 0;
            margin-bottom: 15px;
            text-align: center;
        }
        .sum-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .sum-item {
            background: #3498db;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            min-width: 110px;
            text-align: center;
            font-size: 12px;
        }
        .sum-item span {
            font-weight: bold;
            font-size: 15px;
            display: block;
            margin-top: 5px;
        }
        .total-row {
            background-color: #2c3e50 !important;
            color: white;
            font-weight: bold;
        }
        .numeric-cell {
            color: #2c3e50;
            font-weight: bold;
        }
        .date-header {
            background-color: #34495e !important;
        }
        .weekend {
            background-color: #f8f9fa;
        }
        .empty-cell {
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>

    <h1>üìò ·ã®·ä§·ä≠·à¥·àç ·àò·ãõ·åç·â•·âµ - 30 ·âÄ·äì·âµ ·ãç·àÇ·â•</h1>

    <div class="tabs" id="tabsContainer">
        <!-- ·âµ·à≠·ãé·âΩ ·â†·åÉ·â´·àµ·ä≠·à™·çï·âµ ·ã≠·âÄ·àò·å£·àâ -->
    </div>

    <div id="sheetContent">
        <!-- ·ã®·â∞·àò·à®·å†·ãç ·âµ·à≠ ·ã≠·â≥·ã´·àç -->
    </div>

    <script>
        // ·ã®30 ·âÄ·äì·âµ ·ãç·àÇ·â• ·ã´·àà·ãç 15 ·âµ·àÆ·âΩ
        const sheetsData = [
            {
                name: "·â∞·àµ·çã·ãâ",
                rows: generateTesfawuData()
            },
            {
                name: "·ã≥·â†·à®",
                rows: generateDabereData()
            },
            {
                name: "·å•·â†·â†",
                rows: generateTibebeData()
            },
            {
                name: "·â•·à©·ä≠",
                rows: generateBrukData()
            },
            {
                name: "·ä†·ã´·àà·ãâ",
                rows: generateAyalewuData()
            },
            {
                name: "·ãò·ä´·à≠·ã´·àµ",
                rows: generateZekariyasData()
            },
            {
                name: "·àö·ä´·ä§·àç",
                rows: generateMikaealData()
            },
            {
                name: "·åç·à≠·àõ",
                rows: generateGirmaData()
            },
            {
                name: "·à∞·àà·àû·äï",
                rows: generateSalomonData()
            },
            {
                name: "·ã´·à¨·ãµ",
                rows: generateYaredData()
            },
            {
                name: "·àÑ·äñ·ä≠",
                rows: generateHenokData()
            },
            {
                name: "·àò·àà·à∞",
                rows: generateMelesseData()
            },
            {
                name: "·â∞·àµ·çã·ã¨",
                rows: generateTesfayeData()
            },
            {
                name: "·â•·à≠·àÉ·äë",
                rows: generateBirhanuData()
            },
            {
                name: "·ä†·â†·â†",
                rows: generateAbebeData()
            }
        ];

        // ·ã®30 ·âÄ·äì·âµ ·ãç·àÇ·â• ·ã®·àö·çà·å•·à© ·â∞·åç·â£·à´·âµ
        function generateTesfawuData() {
            const header = ["Tesfawu", "Tesfawu", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Tesfawu", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            // ·ä®26 ·ä•·àµ·ä® 30
            data.push(["Tesfawu", "26", "", "", "", "", "1", "", "3", "", "", "", ""]);
            data.push(["Tesfawu", "27", "", "", "", "", "1", "", "3", "", "", "", ""]);
            data.push(["Tesfawu", "28", "", "", "", "", "", "", "", "", "", "", ""]);
            data.push(["Tesfawu", "29", "", "", "", "", "1", "", "6", "", "", "", ""]);
            data.push(["Tesfawu", "30", "", "", "", "", "1", "", "3", "", "", "", ""]);
            
            // ·ä®1 ·ä•·àµ·ä® 25
            for (let i = 1; i <= 25; i++) {
                let timeKeeper = Math.random() > 0.2 ? "1" : "";
                let guard = "";
                if (i % 7 === 0) { // ·ä•·àÅ·ãµ
                    guard = Math.random() > 0.3 ? "6" : "3";
                } else {
                    guard = Math.random() > 0.2 ? "3" : "";
                }
                
                data.push(["Tesfawu", i.toString(), "", "", "", "", timeKeeper, "", guard, "", "", "", ""]);
            }
            
            return data;
        }

        function generateDabereData() {
            const header = ["Dabere", "Dabere", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Dabere", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            // ·ä®26 ·ä•·àµ·ä® 30
            data.push(["Dabere", "26", "", "", "", "", "", "", "11", "1", "", "", ""]);
            data.push(["Dabere", "27", "", "", "", "", "", "", "11", "1", "", "", ""]);
            data.push(["Dabere", "28", "", "", "", "", "", "", "11", "", "", "", ""]);
            data.push(["Dabere", "29", "", "", "", "", "", "", "11", "1", "", "", ""]);
            data.push(["Dabere", "30", "", "", "", "", "", "", "11", "1", "", "", ""]);
            
            // ·ä®1 ·ä•·àµ·ä® 25
            for (let i = 1; i <= 25; i++) {
                let guard = "";
                let dl = "";
                
                if (i % 7 === 0) { // ·ä•·àÅ·ãµ
                    guard = Math.random() > 0.3 ? "22" : "11";
                } else {
                    guard = Math.random() > 0.2 ? "11" : "";
                }
                
                if (guard && Math.random() > 0.4) {
                    dl = Math.floor(Math.random() * 3 + 1).toString();
                }
                
                data.push(["Dabere", i.toString(), "", "", "", "", "", "", guard, dl, "", "", ""]);
            }
            
            return data;
        }

        function generateTibebeData() {
            const header = ["Tibebe", "Tibebe", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Tibebe", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            // ·ä®26 ·ä•·àµ·ä® 30
            data.push(["Tibebe", "26", "", "", "", "", "", "", "", "9.5", "", "", ""]);
            data.push(["Tibebe", "27", "", "", "", "", "", "", "", "9", "", "", ""]);
            data.push(["Tibebe", "28", "", "", "", "", "", "", "", "4", "", "", ""]);
            data.push(["Tibebe", "29", "", "", "", "", "", "", "", "9", "", "", ""]);
            data.push(["Tibebe", "30", "", "", "", "", "", "", "", "8.5", "", "", ""]);
            
            // ·ä®1 ·ä•·àµ·ä® 25
            for (let i = 1; i <= 25; i++) {
                let dl = (Math.random() * 10 + 1).toFixed(1);
                let carpenter = Math.random() > 0.8 ? "0.5" : "";
                
                data.push(["Tibebe", i.toString(), "", "", carpenter, "", "", "", "", dl, "", "", ""]);
            }
            
            return data;
        }

        function generateBrukData() {
            const header = ["Mulugeta h", "Bruk", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Mulugeta h", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            // ·ä®26 ·ä•·àµ·ä® 30
            data.push(["Mulugeta h", "26", "", "", "1", "", "", "", "", "2", "1", "", ""]);
            data.push(["Mulugeta h", "27", "", "", "1", "", "", "", "8", "3", "1", "", ""]);
            data.push(["Mulugeta h", "28", "", "", "", "", "", "", "", "", "", "", ""]);
            data.push(["Mulugeta h", "29", "", "", "1", "", "", "", "4", "3", "1", "", ""]);
            data.push(["Mulugeta h", "30", "", "", "1", "", "", "", "4", "2", "1", "", ""]);
            
            // ·ä®1 ·ä•·àµ·ä® 25
            for (let i = 1; i <= 25; i++) {
                let carpenter = Math.random() > 0.6 ? "1" : "";
                let guard = "";
                let dl = "";
                let curer = "";
                
                if (carpenter) {
                    guard = Math.random() > 0.5 ? (Math.random() > 0.5 ? "8" : "4") : "";
                    dl = Math.random() > 0.4 ? Math.floor(Math.random() * 4 + 1).toString() : "";
                    curer = Math.random() > 0.6 ? Math.floor(Math.random() * 2 + 1).toString() : "";
                }
                
                data.push(["Mulugeta h", i.toString(), "", "", carpenter, "", "", "", guard, dl, curer, "", ""]);
            }
            
            return data;
        }

        function generateAyalewuData() {
            const header = ["", "Ayalewu", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            // ·ä®26 ·ä•·àµ·ä® 30
            data.push(["", "26", "", "", "", "", "1", "", "2", "", "", "", ""]);
            data.push(["", "27", "", "", "", "", "1", "", "2", "", "", "", ""]);
            data.push(["", "28", "", "", "", "", "", "", "", "", "", "", ""]);
            data.push(["", "29", "", "", "", "", "1", "", "4", "", "", "", ""]);
            data.push(["", "30", "", "", "", "", "2", "", "4", "", "", "", ""]);
            
            // ·ä®1 ·ä•·àµ·ä® 25
            for (let i = 1; i <= 25; i++) {
                let timeKeeper = Math.random() > 0.3 ? "1" : "";
                let guard = "";
                
                if (timeKeeper) {
                    guard = Math.random() > 0.5 ? 
                        (Math.random() > 0.7 ? "10" : 
                         Math.random() > 0.5 ? "5" : "2") : "";
                }
                
                data.push(["", i.toString(), "", "", "", "", timeKeeper, "", guard, "", "", "", ""]);
            }
            
            return data;
        }

        function generateZekariyasData() {
            const header = ["Zekariyas", "Zekariyas", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Zekariyas", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            // ·ä®26 ·ä•·àµ·ä® 30
            data.push(["Zekariyas", "26", "", "", "", "", "1", "", "", "", "", "", ""]);
            data.push(["Zekariyas", "27", "", "", "", "", "1", "", "", "", "", "", ""]);
            data.push(["Zekariyas", "28", "", "", "", "", "", "", "", "", "", "", ""]);
            data.push(["Zekariyas", "29", "", "", "", "", "1", "", "", "", "", "", ""]);
            data.push(["Zekariyas", "30", "", "", "", "", "2", "", "", "", "", "", ""]);
            
            // ·ä®1 ·ä•·àµ·ä® 25
            for (let i = 1; i <= 25; i++) {
                let timeKeeper = Math.random() > 0.4 ? "1" : "";
                let dl = "";
                
                if (timeKeeper && Math.random() > 0.5) {
                    dl = (Math.random() * 10 + 1).toFixed(1);
                }
                
                data.push(["Zekariyas", i.toString(), "", "", "", "", timeKeeper, "", "", dl, "", "", ""]);
            }
            
            return data;
        }

        function generateMikaealData() {
            const header = ["Mikaeal", "Mikaeal", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Mikaeal", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            // ·ä®26 ·ä•·àµ·ä® 30
            data.push(["Mikaeal", "26", "", "", "", "", "", "", "", "24", "", "", ""]);
            data.push(["Mikaeal", "27", "", "", "", "", "", "", "", "23", "", "", ""]);
            data.push(["Mikaeal", "28", "", "", "", "", "", "", "", "", "", "", ""]);
            data.push(["Mikaeal", "29", "", "", "", "", "", "", "", "31", "", "", ""]);
            data.push(["Mikaeal", "30", "", "", "", "", "", "", "", "31", "", "", ""]);
            
            // ·ä®1 ·ä•·àµ·ä® 25
            for (let i = 1; i <= 25; i++) {
                let dl = (Math.random() * 30 + 15).toFixed(1);
                
                data.push(["Mikaeal", i.toString(), "", "", "", "", "", "", "", dl, "", "", ""]);
            }
            
            return data;
        }

        // ·àå·àé·âΩ ·â∞·åç·â£·à´·âµ·äï ·â†·â∞·àò·à≥·à≥·ã≠ ·àò·àç·ä© ·ã≠·çç·å†·à©
        function generateGirmaData() {
            const header = ["Girma", "Girma", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Girma", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Girma", i.toString(), "5", "3", "2", "1", "", "", "", "", "", "", ""]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Girma", i.toString(), "5", "3", "2", "1", "", "", "", "", "", "", ""]);
            }
            
            return data;
        }

        function generateSalomonData() {
            const header = ["Salomon", "Salomon", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Salomon", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Salomon", i.toString(), "", "", "", "", "", "", "7", "", "3", "", ""]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Salomon", i.toString(), "", "", "", "", "", "", "7", "", "3", "", ""]);
            }
            
            return data;
        }

        function generateYaredData() {
            const header = ["Yared", "Yared", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Yared", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Yared", i.toString(), "3", "2", "", "", "", "", "", "", "", "2", "5"]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Yared", i.toString(), "3", "2", "", "", "", "", "", "", "", "2", "5"]);
            }
            
            return data;
        }

        function generateHenokData() {
            const header = ["Henok", "Henok", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Henok", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Henok", i.toString(), "", "", "4", "", "", "", "", "5", "", "", ""]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Henok", i.toString(), "", "", "4", "", "", "", "", "5", "", "", ""]);
            }
            
            return data;
        }

        function generateMelesseData() {
            const header = ["Melesse", "Melesse", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Melesse", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Melesse", i.toString(), "", "", "", "2", "1", "", "", "", "", "", ""]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Melesse", i.toString(), "", "", "", "2", "1", "", "", "", "", "", ""]);
            }
            
            return data;
        }

        function generateTesfayeData() {
            const header = ["Tesfaye", "Tesfaye", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Tesfaye", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Tesfaye", i.toString(), "", "6", "", "", "", "", "", "", "", "", "8"]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Tesfaye", i.toString(), "", "6", "", "", "", "", "", "", "", "", "8"]);
            }
            
            return data;
        }

        function generateBirhanuData() {
            const header = ["Birhanu", "Birhanu", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Birhanu", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Birhanu", i.toString(), "", "", "", "", "", "2", "", "", "", "", ""]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Birhanu", i.toString(), "", "", "", "", "", "2", "", "", "", "", ""]);
            }
            
            return data;
        }

        function generateAbebeData() {
            const header = ["Abebe", "Abebe", "", "", "", "", "", "", "", "", "", "", ""];
            const columns = ["Abebe", "Date", "Mason", "Barbender", "Carpenter", "Store", "Time Keeper", "Surveyor", "Guard", "Dl", "Curer", "Guard @ shewarobit", "Concrete labour"];
            const data = [];
            
            data.push(header);
            data.push(columns);
            
            for (let i = 26; i <= 30; i++) {
                data.push(["Abebe", i.toString(), "", "", "", "", "", "", "9", "2", "", "", ""]);
            }
            
            for (let i = 1; i <= 25; i++) {
                data.push(["Abebe", i.toString(), "", "", "", "", "", "", "9", "2", "", "", ""]);
            }
            
            return data;
        }

        // ·âµ·à≠ ·âÅ·àç·çé·âΩ·äï ·ã≠·çç·å†·à©
        const tabsContainer = document.getElementById('tabsContainer');
        const sheetContent = document.getElementById('sheetContent');

        sheetsData.forEach((sheet, index) => {
            const button = document.createElement('button');
            button.className = 'tab-button';
            button.textContent = `${index + 1}. ${sheet.name}`;
            button.addEventListener('click', () => showSheet(index));
            tabsContainer.appendChild(button);
        });

        // ·ã®·àò·åÄ·àò·à™·ã´ ·âµ·à≠ ·ä†·à≥·ã≠
        if (sheetsData.length > 0) {
            showSheet(0);
            document.querySelector('.tab-button').classList.add('active');
        }

        // ·ä†·àù·ãµ ·ãµ·àù·à≠ ·ä†·àµ·àã
        function calculateColumnSums(rows) {
            if (rows.length < 3) return [];
            
            const sums = new Array(rows[0].length).fill(0);
            const hasNumericData = new Array(rows[0].length).fill(false);
            
            // ·ä®·àÅ·àà·â∞·äõ·ãç ·à®·ãµ·çç ·åÄ·àù·àÆ (·ã®·ãç·àÇ·â• ·à®·ãµ·çé·âΩ)
            for (let i = 2; i < rows.length; i++) {
                const row = rows[i];
                for (let j = 0; j < row.length; j++) {
                    const cell = row[j];
                    // ·âÅ·å•·à≠ ·ä®·àÜ·äê ·ãµ·àù·à≠ ·àã·ã≠ ·å®·àù·à≠
                    const num = parseFloat(cell);
                    if (!isNaN(num) && cell !== '' && cell !== ' ') {
                        sums[j] += num;
                        hasNumericData[j] = true;
                    }
                }
            }
            
            return sums.map((sum, index) => ({
                sum: sum,
                hasData: hasNumericData[index],
                columnName: rows[1][index] || `·ä†·àù·ãµ ${index + 1}`
            }));
        }

        // ·ã®·å†·âÖ·àã·àã ·ãµ·àù·à≠ ·ä†·àµ·àã
        function calculateTotalSum(columnSums) {
            return columnSums.reduce((total, col) => total + col.sum, 0);
        }

        function showSheet(index) {
            const sheet = sheetsData[index];
            sheetContent.innerHTML = '';

            // ·ã®·âµ·à≠ ·à≠·ãï·àµ
            const title = document.createElement('div');
            title.className = 'sheet-title';
            title.textContent = `üìã ·âµ·à≠: ${sheet.name} - 30 ·âÄ·äì·âµ ·ãç·àÇ·â•`;
            sheetContent.appendChild(title);

            // ·àµ·â≥·â≤·àµ·â≤·ä≠·àµ
            const stats = document.createElement('div');
            stats.className = 'stats';
            const totalRows = sheet.rows.length - 2;
            const totalCells = sheet.rows.reduce((sum, row) => sum + row.filter(cell => cell !== '').length, 0);
            
            // ·ä†·àù·ã∂·âΩ ·ãµ·àù·à≠ ·ä†·àµ·àã
            const columnSums = calculateColumnSums(sheet.rows);
            const totalSum = calculateTotalSum(columnSums);
            
            stats.innerHTML = `
                <strong>·ã®·âµ·à≠ ·àò·à®·åÉ:</strong><br>
                ‚Ä¢ ·ä†·å†·âÉ·àã·ã≠ ·âÄ·äì·âµ: <span>30</span> (26-30 ·ä•·äì 1-25)<br>
                ‚Ä¢ ·ã®·à®·ãµ·çé·âΩ ·â•·ãõ·âµ: <span>${sheet.rows.length}</span><br>
                ‚Ä¢ ·ã®·ãç·àÇ·â• ·à®·ãµ·çé·âΩ: <span>${totalRows}</span><br>
                ‚Ä¢ ·ã®·â∞·àû·àâ ·àï·ãã·à≥·âµ: <span>${totalCells}</span><br>
                ‚Ä¢ ·å†·âÖ·àã·àã ·ãµ·àù·à≠: <span style="color: #e74c3c;">${totalSum.toFixed(2)}</span>
            `;
            sheetContent.appendChild(stats);

            // ·ä†·àù·ãµ ·ãµ·àù·à≠ ·àõ·å†·âÉ·àà·ã´
            const columnSummary = document.createElement('div');
            columnSummary.className = 'column-summary';
            const summaryTitle = document.createElement('h3');
            summaryTitle.textContent = 'üìä ·ä†·àù·ã∂·âΩ ·ãµ·àù·à≠ (30 ·âÄ·äì·âµ)';
            columnSummary.appendChild(summaryTitle);
            
            const sumRow = document.createElement('div');
            sumRow.className = 'sum-row';
            
            columnSums.forEach((col, colIndex) => {
                if (col.hasData && colIndex > 0) { // ·ã®·âÄ·äï ·ä†·àù·ãµ ·ä†·äï·à∞·à´·àù
                    const sumItem = document.createElement('div');
                    sumItem.className = 'sum-item';
                    sumItem.innerHTML = `
                        <div>${col.columnName}</div>
                        <span>${col.sum.toFixed(2)}</span>
                    `;
                    
                    // ·ã®·â∞·àà·ã´·ã® ·âÄ·àà·àù ·àà·â∞·àà·ã´·ã© ·ä†·àù·ã∂·âΩ
                    const colors = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6', '#1abc9c', '#d35400', '#27ae60', '#8e44ad', '#f1c40f'];
                    sumItem.style.backgroundColor = colors[(colIndex - 1) % colors.length];
                    
                    sumRow.appendChild(sumItem);
                }
            });
            
            columnSummary.appendChild(sumRow);
            sheetContent.appendChild(columnSummary);

            // ·à†·äï·å†·à®·ã• ·çç·å†·à≠
            const table = document.createElement('table');
            const thead = document.createElement('thead');
            const tbody = document.createElement('tbody');

            // ·ä†·à≠·ãï·àµ·âµ ·à®·ãµ·çç
            if (sheet.rows.length > 1) {
                const headerRow = document.createElement('tr');
                sheet.rows[1].forEach((cell, index) => {
                    const th = document.createElement('th');
                    th.textContent = cell || '';
                    if (index === 1) {
                        th.className = 'date-header';
                        th.textContent = "Date (26-30, 1-25)";
                    }
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
            }

            // ·ãç·àÇ·â• ·à®·ãµ·çé·âΩ (·ä®·àÅ·àà·â∞·äõ·ãç ·åÄ·àù·àÆ)
            for (let i = 2; i < sheet.rows.length; i++) {
                const row = document.createElement('tr');
                const date = parseInt(sheet.rows[i][1]);
                
                // ·ä•·àÅ·ãµ ·ä®·àÜ·äê ·àç·ã© ·ä≠·çç·àç
                if (date % 7 === 0) {
                    row.className = 'weekend';
                }
                
                sheet.rows[i].forEach((cell, cellIndex) => {
                    const td = document.createElement('td');
                    td.textContent = cell || '';
                    
                    // ·â£·ã∂ ·àï·ãã·à≥·âµ
                    if (cell === '') {
                        td.className = 'empty-cell';
                    }
                    
                    // ·âÅ·å•·àÆ·âΩ·äï ·âÄ·àà·àù ·àà·ã≠
                    const num = parseFloat(cell);
                    if (!isNaN(num) && cell !== '' && cell !== ' ') {
                        td.className = 'numeric-cell';
                        // ·âµ·àç·âÖ ·âÅ·å•·àÆ·âΩ ·ã®·â∞·àà·ã® ·âÄ·àà·àù
                        if (num >= 20) {
                            td.style.color = '#e74c3c';
                        } else if (num >= 10) {
                            td.style.color = '#f39c12';
                        }
                    }
                    
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            }

            // ·ãµ·àù·à≠ ·à®·ãµ·çç ·å®·àù·à≠
            const totalRow = document.createElement('tr');
            totalRow.className = 'total-row';
            
            columnSums.forEach((col, colIndex) => {
                const td = document.createElement('td');
                if (colIndex === 0) {
                    td.textContent = "·å†·âÖ·àã·àã";
                    td.style.fontWeight = 'bold';
                } else if (colIndex === 1) {
                    td.textContent = "·ãµ·àù·à≠";
                    td.style.fontWeight = 'bold';
                } else if (col.hasData) {
                    td.textContent = col.sum.toFixed(2);
                    td.style.fontWeight = 'bold';
                    td.style.fontSize = '14px';
                } else {
                    td.textContent = '-';
                }
                totalRow.appendChild(td);
            });
            
            tbody.appendChild(totalRow);

            table.appendChild(thead);
            table.appendChild(tbody);
            sheetContent.appendChild(table);

            // ·äï·âÅ ·âµ·à≠ ·ä†·ãµ·à≠·åç
            document.querySelectorAll('.tab-button').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });

            // ·ãà·ã∞ ·àã·ã≠ ·ä†·äï·à≥
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>

</body>
</html>